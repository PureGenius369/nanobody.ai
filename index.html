<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NanobodyAI Predictor PRO</title>

<style>
body{font-family:Segoe UI;background:#eef3fb;margin:0}
.container{max-width:1100px;margin:30px auto;padding:20px}
.card{background:white;border-radius:14px;padding:20px;margin-bottom:20px;box-shadow:0 2px 12px rgba(0,0,0,.08)}
button{background:#ff6b35;color:white;padding:15px;border:none;border-radius:10px;font-weight:700;width:100%;cursor:pointer}
.metric{display:inline-block;width:30%;text-align:center;padding:12px;background:#f8faff;border-radius:10px;margin:6px}
</style>
</head>

<body>

<div style="background:#003d82;color:white;padding:20px">
<h2>ðŸ§¬ NanobodyAI Predictor â€” PRO Scientific Model</h2>
<p>Receptor Physics â€¢ BBB Transport â€¢ PK/PD Simulation</p>
</div>

<div class="container">

<div class="card">

<h3>Target Receptor</h3>
<select id="receptor">
<option>mGluR5</option>
<option>mGlu2</option>
<option>NMDA</option>
<option>D2 Dopamine</option>
<option>5-HT2A</option>
<option>GABA-A</option>
<option>TrkB</option>
</select>

<h3>Engineering</h3>
<select id="mod">
<option>None</option>
<option>PEGylation</option>
<option>Fc Fusion</option>
<option>TfR Bispecific</option>
<option>CPP Conjugation</option>
<option>Albumin Binding</option>
</select>

<h3>Biophysical Parameters</h3>
<div id="sliders"></div>

<button onclick="runPrediction()">Run PRO Simulation</button>

</div>

<div class="card" id="output"></div>

</div>

<script>

// -----------------------------
const FEATURES=[
{id:"mw",label:"Molecular Weight (kDa)",min:10,max:30,step:.5,def:15},
{id:"cdr3",label:"CDR3 Length",min:5,max:25,step:1,def:14},
{id:"hydro",label:"Hydrophobicity",min:-3,max:3,step:.1,def:.5},
{id:"pi",label:"Isoelectric Point",min:4,max:10,step:.1,def:7},
{id:"charge",label:"Net Charge",min:-5,max:5,step:1,def:1},
{id:"tm",label:"Thermostability Â°C",min:40,max:90,step:1,def:68}
];

const sliderVals={};

FEATURES.forEach(f=>{
sliderVals[f.id]=f.def;
document.getElementById("sliders").innerHTML+=`
<label>${f.label}: <span id="v-${f.id}">${f.def}</span></label>
<input type="range" min="${f.min}" max="${f.max}" step="${f.step}" value="${f.def}"
oninput="sliderVals['${f.id}']=parseFloat(this.value);document.getElementById('v-${f.id}').innerText=this.value">
<br><br>`;
});

// -----------------------------
// RECEPTOR PHYSICS DATABASE
// -----------------------------
const receptorPhysics={
"mGluR5":{difficulty:0.7,bbbNeed:0.6},
"mGlu2":{difficulty:0.5,bbbNeed:0.5},
"NMDA":{difficulty:0.9,bbbNeed:0.8},
"D2 Dopamine":{difficulty:0.6,bbbNeed:0.7},
"5-HT2A":{difficulty:0.55,bbbNeed:0.6},
"GABA-A":{difficulty:0.8,bbbNeed:0.7},
"TrkB":{difficulty:0.95,bbbNeed:0.85}
};

// -----------------------------
// UTIL
// -----------------------------
function clamp(v,min,max){return Math.max(min,Math.min(max,v));}

// -----------------------------
// CORE PRO MODEL
// -----------------------------
function runPrediction(){

const v=sliderVals;
const receptor=document.getElementById("receptor").value;
const mod=document.getElementById("mod").value;
const phys=receptorPhysics[receptor];

// ---- STRUCTURAL STABILITY ----
let foldingEnergy=(v.tm-60)*1.5-Math.abs(v.hydro)*6;
let stability=clamp(60+foldingEnergy,5,98);

// ---- BINDING ENTROPY MODEL ----
let bindingEntropy=v.cdr3*1.4-Math.abs(v.hydro)*2;
let receptorPenalty=phys.difficulty*25;
let kd=clamp(45-bindingEntropy+receptorPenalty,0.3,95);

// ---- BBB ACTIVE TRANSPORT ----
let bbb=3+v.charge*0.7-(v.mw-15)*0.2;
if(mod==="TfR Bispecific")bbb+=3;
if(mod==="CPP Conjugation")bbb+=2;
bbb-=phys.bbbNeed*2;
bbb=clamp(bbb,0.1,9.5);

// ---- PHARMACOKINETICS ----
let halfLife=6+stability*0.5;
if(mod==="Fc Fusion")halfLife*=3;
if(mod==="PEGylation")halfLife*=2;
if(mod==="Albumin Binding")halfLife*=1.8;
halfLife=clamp(halfLife,1,120);

// ---- CNS DRUG-LIKENESS ----
let cnsScore=50;
if(v.pi>=6.5&&v.pi<=8.5)cnsScore+=15;
if(v.mw<18)cnsScore+=10;
if(Math.abs(v.hydro)<1.2)cnsScore+=10;
cnsScore=clamp(cnsScore,5,98);

// ---- TRANSLATIONAL INDEX ----
let translational=
0.3*stability+
0.3*(100-kd)+
0.2*(bbb*10)+
0.2*cnsScore;

translational=clamp(translational,5,99);

// ---- GRADE ----
let grade="D";
if(translational>85)grade="A+";
else if(translational>75)grade="A";
else if(translational>65)grade="B+";
else if(translational>55)grade="B";
else if(translational>40)grade="C";

// ---- OUTPUT ----
document.getElementById("output").innerHTML=`

<h2>PRO Simulation Result</h2>

<div class="metric"><b>KD</b><br>${kd.toFixed(2)} nM</div>
<div class="metric"><b>BBB</b><br>${(bbb*10).toFixed(1)}%</div>
<div class="metric"><b>Half-life</b><br>${Math.round(halfLife)} h</div>

<hr>

<p><b>Structural Stability:</b> ${Math.round(stability)}</p>
<p><b>CNS Drug-Likeness:</b> ${Math.round(cnsScore)}</p>
<p><b>Translational Score:</b> ${Math.round(translational)}</p>

<h2>Clinical Grade: ${grade}</h2>

<p>
${translational>80?
"Excellent clinical translation potential with strong receptor engagement and CNS delivery.":
translational>60?
"Promising candidate requiring optimisation for clinical advancement.":
"Significant engineering refinement required before translational consideration."}
</p>

`;
}

</script>
</body>
</html>
