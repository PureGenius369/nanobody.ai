<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>NanobodyAI Predictor ‚Äì Mann Sutariya, PDEU</title>
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{--navy:#003d82;--blue:#0057b8;--sky:#4a90e2;--orange:#ff6b35;--red:#e63946;--green:#059669;--gold:#d97706;--bg:#eef3fb;--card:#fff;--text:#1e293b;--muted:#64748b;--border:#e2e8f0}
body{font-family:'Segoe UI',Arial,sans-serif;background:var(--bg);min-height:100vh;color:var(--text)}
input[type=range]{-webkit-appearance:none;width:100%;height:6px;border-radius:3px;background:var(--border);outline:none;cursor:pointer}
input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;width:18px;height:18px;border-radius:50%;background:var(--navy);cursor:pointer}
select{width:100%;padding:10px 14px;border:2px solid var(--border);border-radius:10px;font-size:13px;font-weight:600;color:var(--navy);background:#f8faff;cursor:pointer;outline:none;font-family:inherit}
select:focus{border-color:var(--sky)}
.card{background:var(--card);border-radius:14px;padding:22px;box-shadow:0 2px 12px rgba(0,0,0,.07)}
.sec-head{font-size:12px;font-weight:700;color:var(--navy);text-transform:uppercase;letter-spacing:.06em;border-bottom:2px solid var(--orange);padding-bottom:8px;margin-bottom:16px}
.btn{width:100%;padding:16px;border:none;border-radius:12px;font-size:15px;font-weight:800;font-family:inherit;color:#fff;cursor:pointer;background:linear-gradient(135deg,var(--orange),var(--red));box-shadow:0 4px 18px rgba(255,107,53,.4);transition:transform .15s,opacity .2s}
.btn:hover{transform:translateY(-2px)}
.btn:disabled{background:#94a3b8;box-shadow:none;cursor:not-allowed;transform:none}
.tag{display:inline-block;padding:3px 11px;border-radius:20px;font-size:11px;font-weight:700;color:#fff}
.metric-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin:14px 0}
.metric-box{background:#f8faff;border:1px solid var(--border);border-radius:10px;padding:14px 10px;text-align:center}
.gauge-track{height:9px;background:var(--border);border-radius:5px;overflow:hidden;margin-top:4px}
.gauge-fill{height:100%;border-radius:5px;transition:width 1s ease}
.sw-row{font-size:12px;line-height:1.5;display:flex;gap:7px;margin-bottom:6px}
@keyframes spin{to{transform:rotate(360deg)}}
@keyframes pulse{0%,100%{opacity:.3}50%{opacity:1}}
@keyframes fadeUp{from{opacity:0;transform:translateY(16px)}to{opacity:1;transform:translateY(0)}}
.fade-up{animation:fadeUp .4s ease both}
.tip-num{width:20px;height:20px;border-radius:50%;background:var(--gold);color:#fff;font-size:10px;font-weight:700;display:flex;align-items:center;justify-content:center;flex-shrink:0;margin-top:1px}
#spinner{font-size:44px;animation:spin 1.8s linear infinite;display:inline-block}
@media(max-width:800px){#main-grid{grid-template-columns:1fr!important}.metric-grid{grid-template-columns:repeat(2,1fr)}}
</style>
</head>
<body>
<div style="background:linear-gradient(135deg,#003d82,#0057b8);color:#fff;padding:24px 32px;box-shadow:0 4px 20px rgba(0,61,130,.3)">
  <div style="max-width:1100px;margin:0 auto;display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:14px">
    <div style="display:flex;align-items:center;gap:14px">
      <span style="font-size:38px">üß¨</span>
      <div>
        <h1 style="font-size:22px;font-weight:900;margin:0">NanobodyAI Predictor</h1>
        <p style="font-size:12px;opacity:.85;margin:0">AI-Powered Nanobody Affinity &amp; BBB Penetration Model for Neuropsychiatric Targets</p>
      </div>
    </div>
    <div style="display:flex;gap:8px;flex-wrap:wrap">
      <span class="tag" style="background:rgba(255,255,255,.18)">Biophysical Features</span>
      <span class="tag" style="background:rgba(255,255,255,.18)">Receptor Specificity</span>
      <span class="tag" style="background:rgba(255,255,255,.18)">BBB Transport</span>
      <span class="tag" style="background:rgba(255,255,255,.18)">Clinical Translation</span>
    </div>
  </div>
</div>
<div id="main-grid" style="max-width:1100px;margin:28px auto;padding:0 20px;display:grid;grid-template-columns:1fr 1fr;gap:24px">
  <div style="display:flex;flex-direction:column;gap:18px">
    <div class="card">
      <div class="sec-head">üéØ Target Configuration</div>
      <label style="font-size:12px;font-weight:600;color:#475569;display:block;margin-bottom:6px">Brain Receptor Target</label>
      <select id="receptor" style="margin-bottom:14px">
        <option>mGluR5</option><option>mGlu2</option><option>D2 Dopamine</option>
        <option>5-HT2A Serotonin</option><option>NMDA</option><option>GABA-A</option>
        <option>TrkB</option><option>mGluR3</option>
      </select>
      <label style="font-size:12px;font-weight:600;color:#475569;display:block;margin-bottom:6px">Engineering Modification</label>
      <select id="modification">
        <option>None</option><option>PEGylation (20 kDa)</option><option>Fc Fusion</option>
        <option>TfR Bispecific</option><option>CPP Conjugation</option><option>Albumin Binding</option>
      </select>
    </div>
    <div class="card">
      <div class="sec-head">‚öóÔ∏è Biophysical Parameters</div>
      <div id="sliders"></div>
    </div>
    <button class="btn" id="predictBtn" onclick="runPrediction()">üöÄ Run AI Prediction</button>
    <div style="font-size:11px;color:#94a3b8;text-align:center;line-height:1.7">
      Powered by Claude AI ¬∑ For academic &amp; research use only<br>
      <strong style="color:#003d82">Mann Sutariya ¬∑ PDEU, Gandhinagar</strong>
    </div>
  </div>
  <div>
    <div class="card" id="results-panel" style="min-height:460px">
      <div id="placeholder" style="display:flex;flex-direction:column;align-items:center;justify-content:center;padding:50px 20px;text-align:center">
        <div style="font-size:60px;margin-bottom:16px">üß™</div>
        <h3 style="color:#003d82;font-size:19px;margin-bottom:10px">Ready to Predict</h3>
        <p style="color:#64748b;font-size:13px;line-height:1.7;max-width:300px">Configure your nanobody parameters and click <strong>Run AI Prediction</strong> to receive binding affinity, BBB penetration, clinical grade, and optimisation tips.</p>
        <div style="margin-top:20px;text-align:left">
          <div style="font-size:12px;color:#475569;margin-bottom:7px">‚Üí Predicted K_D (binding affinity)</div>
          <div style="font-size:12px;color:#475569;margin-bottom:7px">‚Üí BBB penetration estimate</div>
          <div style="font-size:12px;color:#475569;margin-bottom:7px">‚Üí Half-life prediction</div>
          <div style="font-size:12px;color:#475569;margin-bottom:7px">‚Üí Clinical grade &amp; outlook</div>
          <div style="font-size:12px;color:#475569">‚Üí Optimisation suggestions</div>
        </div>
      </div>
      <div id="loading" style="display:none;flex-direction:column;align-items:center;justify-content:center;padding:50px 20px;text-align:center">
        <div id="spinner">‚öôÔ∏è</div>
        <h3 style="color:#003d82;margin:16px 0 20px">Analysing Properties‚Ä¶</h3>
        <div style="display:flex;flex-direction:column;gap:9px">
          <div style="display:flex;align-items:center;gap:10px"><div style="width:9px;height:9px;border-radius:50%;background:#4a90e2;animation:pulse 1s 0s infinite"></div><span style="font-size:12px;color:#64748b">Computing binding thermodynamics</span></div>
          <div style="display:flex;align-items:center;gap:10px"><div style="width:9px;height:9px;border-radius:50%;background:#4a90e2;animation:pulse 1s .25s infinite"></div><span style="font-size:12px;color:#64748b">Modelling BBB transport</span></div>
          <div style="display:flex;align-items:center;gap:10px"><div style="width:9px;height:9px;border-radius:50%;background:#4a90e2;animation:pulse 1s .5s infinite"></div><span style="font-size:12px;color:#64748b">Evaluating pharmacokinetics</span></div>
          <div style="display:flex;align-items:center;gap:10px"><div style="width:9px;height:9px;border-radius:50%;background:#4a90e2;animation:pulse 1s .75s infinite"></div><span style="font-size:12px;color:#64748b">Generating clinical insights</span></div>
        </div>
      </div>
      <div id="output" style="display:none"></div>
    </div>
  </div>
</div>
<script>
const FEATURES=[
  {id:"mw",label:"Molecular Weight",unit:"kDa",min:10,max:30,step:.5,def:15,hint:"Typical nanobody: 12‚Äì18 kDa"},
  {id:"cdr3",label:"CDR3 Loop Length",unit:"aa",min:5,max:25,step:1,def:14,hint:"Longer CDR3 ‚Üí higher specificity"},
  {id:"hydro",label:"Hydrophobicity Index",unit:"",min:-3,max:3,step:.1,def:.5,hint:"Lower = better aqueous solubility"},
  {id:"pi",label:"Isoelectric Point pI",unit:"",min:4,max:10,step:.1,def:7.0,hint:"Optimal 6.5‚Äì8.5 for CNS targeting"},
  {id:"charge",label:"Net Charge at pH 7.4",unit:"",min:-5,max:5,step:1,def:1,hint:"Slight + charge aids BBB crossing"},
  {id:"tm",label:"Thermostability Tm",unit:"¬∞C",min:40,max:90,step:1,def:68,hint:"Higher Tm ‚Üí more stable nanobody"},
];
const sliderVals={};
FEATURES.forEach(f=>{
  sliderVals[f.id]=f.def;
  const pct=((f.def-f.min)/(f.max-f.min))*100;
  document.getElementById('sliders').innerHTML+=`
  <div style="margin-bottom:18px">
    <div style="display:flex;justify-content:space-between;margin-bottom:5px">
      <span style="font-size:12px;font-weight:600">${f.label}</span>
      <span id="val-${f.id}" style="font-size:12px;font-weight:700;background:#e8f0fe;color:#003d82;padding:2px 9px;border-radius:10px">${f.def}${f.unit}</span>
    </div>
    <div style="position:relative;height:6px;background:#e2e8f0;border-radius:3px">
      <div id="track-${f.id}" style="position:absolute;height:100%;border-radius:3px;background:linear-gradient(90deg,#4a90e2,#003d82);width:${pct}%"></div>
      <input type="range" min="${f.min}" max="${f.max}" step="${f.step}" value="${f.def}" id="range-${f.id}"
        style="position:absolute;width:100%;height:100%;opacity:0;margin:0;padding:0"
        oninput="upd('${f.id}','${f.unit}',${f.min},${f.max},this.value)">
    </div>
    <div style="font-size:10px;color:#94a3b8;margin-top:3px">üí° ${f.hint}</div>
  </div>`;
});
function upd(id,unit,min,max,val){
  sliderVals[id]=val;
  const disp=parseFloat(val).toFixed(id==='hydro'||id==='pi'||id==='mw'?1:0);
  document.getElementById('val-'+id).textContent=disp+unit;
  document.getElementById('track-'+id).style.width=((val-min)/(max-min))*100+'%';
}
function gc(g){return{'A+':'#059669','A':'#059669','B+':'#0057b8','B':'#0057b8','C':'#d97706','D':'#e63946'}[g]||'#1e293b'}
function ring(score){
  const r=38,circ=2*Math.PI*r,dash=(score/100)*circ;
  const col=score>70?'#059669':score>40?'#d97706':'#e63946';
  return`<svg width="90" height="90" viewBox="0 0 90 90"><circle cx="45" cy="45" r="${r}" fill="none" stroke="#e2e8f0" stroke-width="8"/><circle cx="45" cy="45" r="${r}" fill="none" stroke="${col}" stroke-width="8" stroke-dasharray="${dash} ${circ-dash}" stroke-dashoffset="${circ/4}" stroke-linecap="round"/><text x="45" y="51" text-anchor="middle" fill="${col}" font-weight="700" font-size="20" font-family="inherit">${score}</text></svg><div style="font-size:11px;font-weight:600;color:#003d82;text-align:center;margin-top:-4px">Overall</div>`;
}
function gauge(label,value){
  const col=value>70?'#059669':value>40?'#d97706':'#e63946';
  return`<div style="margin-bottom:11px"><div style="display:flex;justify-content:space-between;margin-bottom:4px"><span style="font-size:12px;font-weight:600">${label}</span><span style="font-size:12px;font-weight:700;color:${col}">${value}/100</span></div><div class="gauge-track"><div class="gauge-fill" style="width:${value}%;background:linear-gradient(90deg,${col}88,${col})"></div></div></div>`;
}
function show(state){
  document.getElementById('placeholder').style.display=state==='idle'?'flex':'none';
  document.getElementById('loading').style.display=state==='loading'?'flex':'none';
  document.getElementById('output').style.display=state==='result'?'block':'none';
}async function runPrediction() {

  const btn = document.getElementById('predictBtn');
  btn.disabled = true;
  btn.textContent = 'üî¨ Analysing Nanobody‚Ä¶';
  show('loading');

  // Get inputs
  const rec = document.getElementById('receptor').value;
  const mod = document.getElementById('modification').value;
  const v = sliderVals;

  // --- SCIENTIFIC SCORING MODEL ---

  // Stability score (Tm + hydrophobicity)
  let stability = 50;
  stability += (v.tm - 60) * 1.2;
  stability -= Math.abs(v.hydro) * 8;
  stability = clamp(stability, 10, 95);

  // Selectivity score (CDR3 + pI range)
  let selectivity = 40;
  selectivity += (v.cdr3 - 10) * 2.5;
  if (v.pi >= 6.5 && v.pi <= 8.5) selectivity += 10;
  selectivity = clamp(selectivity, 10, 95);

  // BBB penetration (charge + weight + modification)
  let bbb = 3;
  bbb += v.charge * 0.6;
  bbb -= (v.mw - 15) * 0.15;

  if (mod.includes("TfR")) bbb += 2.5;
  if (mod.includes("CPP")) bbb += 1.5;
  if (mod.includes("PEG")) bbb -= 0.8;
  if (mod.includes("Fc")) bbb -= 1.2;

  bbb = clamp(bbb, 0.1, 9.5);

  // Binding affinity (lower is better)
  let kd = 40;
  kd -= (v.cdr3 - 12) * 1.8;
  kd -= (selectivity - 50) * 0.2;
  kd += Math.abs(v.hydro) * 3;
  kd = clamp(kd, 0.5, 95);

  // Half life
  let halfLife = 8 + stability * 0.6;
  if (mod.includes("PEG")) halfLife *= 2;
  if (mod.includes("Fc")) halfLife *= 3;
  if (mod.includes("Albumin")) halfLife *= 1.8;
  halfLife = clamp(halfLife, 1, 120);

  // Overall score
  let overall = Math.round(
    selectivity * 0.35 +
    stability * 0.25 +
    (100 - kd) * 0.25 +
    bbb * 6
  );
  overall = clamp(overall, 10, 98);

  // Grade
  let grade = "D";
  if (overall > 85) grade = "A+";
  else if (overall > 75) grade = "A";
  else if (overall > 65) grade = "B+";
  else if (overall > 55) grade = "B";
  else if (overall > 40) grade = "C";

  // Verdict
  let verdict =
    overall > 80 ? "Excellent Candidate" :
    overall > 65 ? "Good Candidate" :
    overall > 50 ? "Moderate Candidate" :
    "Poor Candidate";

  // Strengths
  const strengths = [];
  if (kd < 10) strengths.push("High binding affinity");
  if (bbb > 5) strengths.push("Strong BBB penetration");
  if (stability > 75) strengths.push("Excellent structural stability");
  if (selectivity > 75) strengths.push("High receptor specificity");
  if (halfLife > 40) strengths.push("Extended systemic half-life");

  // Weaknesses
  const weaknesses = [];
  if (kd > 40) weaknesses.push("Weak binding affinity");
  if (bbb < 2) weaknesses.push("Limited BBB transport");
  if (stability < 40) weaknesses.push("Low thermal stability");
  if (selectivity < 40) weaknesses.push("Limited receptor selectivity");

  // Optimization tips
  const tips = [];
  if (bbb < 3) tips.push("Consider TfR bispecific engineering to enhance BBB transport");
  if (kd > 20) tips.push("Increase CDR3 length or optimize binding interface");
  if (stability < 60) tips.push("Introduce stabilizing mutations to improve folding");
  if (halfLife < 20) tips.push("Add Fc fusion or PEGylation for half-life extension");

  if (tips.length < 3) {
    tips.push("Optimize hydrophobicity balance for solubility");
    tips.push("Fine-tune isoelectric point for CNS compatibility");
  }

  // Clinical outlook
  const outlook =
    overall > 75
      ? "Candidate demonstrates strong translational potential with favorable pharmacokinetics and CNS accessibility. Suitable for preclinical validation."
      : overall > 55
      ? "Candidate shows moderate therapeutic promise but requires molecular optimization before clinical progression."
      : "Significant engineering optimisation required before translational consideration.";

  const result = {
    kd_nm: Number(kd.toFixed(2)),
    bbb_penetration: Number((bbb * 10).toFixed(1)),
    half_life_h: Math.round(halfLife),
    selectivity_score: Math.round(selectivity),
    stability_score: Math.round(stability),
    overall_score: Math.round(overall),
    grade,
    verdict,
    key_strengths: strengths.slice(0,3),
    key_weaknesses: weaknesses.slice(0,2),
    optimization_tips: tips.slice(0,3),
    clinical_outlook: outlook,
    similar_approved: "Caplacizumab (reference nanobody therapeutic)",
    confidence: Math.round(70 + overall * 0.25)
  };

  setTimeout(() => {
    renderResult(result, rec);
    btn.disabled = false;
    btn.textContent = 'üöÄ Run AI Prediction';
  }, 1200);
}

function clamp(v,min,max){
  return Math.max(min, Math.min(max, v));
}

function renderResult(d,rec){
  const col=gc(d.grade);
  const strengths=d.key_strengths.map(s=>`<div class="sw-row"><span style="color:#059669;font-weight:700">‚ñ∏</span><span style="color:#166534">${s}</span></div>`).join('');
  const weaknesses=d.key_weaknesses.map(w=>`<div class="sw-row"><span style="color:#dc2626;font-weight:700">‚ñ∏</span><span style="color:#7f1d1d">${w}</span></div>`).join('');
  const tips=d.optimization_tips.map((t,i)=>`<div style="display:flex;gap:10px;align-items:flex-start;margin-bottom:8px"><div class="tip-num">${i+1}</div><span style="font-size:12px;color:#78350f;line-height:1.55">${t}</span></div>`).join('');
  document.getElementById('output').innerHTML=`
  <div class="fade-up" style="display:flex;flex-direction:column;gap:16px">
    <div style="background:linear-gradient(135deg,${col},${col}bb);border-radius:14px;padding:20px 24px;display:flex;justify-content:space-between;align-items:center;color:#fff;box-shadow:0 4px 16px ${col}44">
      <div>
        <div style="font-size:30px;font-weight:900">Grade: ${d.grade}</div>
        <div style="font-size:15px;font-weight:600;opacity:.9">${d.verdict}</div>
        <div style="font-size:11px;opacity:.75;margin-top:4px">Confidence: ${d.confidence}% ¬∑ Target: ${rec}</div>
      </div>
      <div>${ring(d.overall_score)}</div>
    </div>
    <div>
      <div style="font-size:13px;font-weight:700;color:#003d82;margin-bottom:10px">üìä Predicted Metrics</div>
      <div class="metric-grid">
        <div class="metric-box"><div style="font-size:22px;margin-bottom:4px">üîó</div><div style="font-size:16px;font-weight:800;color:#003d82">${d.kd_nm} nM</div><div style="font-size:10px;color:#64748b;margin-top:3px">K_D Binding Affinity</div></div>
        <div class="metric-box"><div style="font-size:22px;margin-bottom:4px">üß†</div><div style="font-size:16px;font-weight:800;color:#003d82">${d.bbb_penetration}%</div><div style="font-size:10px;color:#64748b;margin-top:3px">BBB Penetration</div></div>
        <div class="metric-box"><div style="font-size:22px;margin-bottom:4px">‚è±Ô∏è</div><div style="font-size:16px;font-weight:800;color:#003d82">${d.half_life_h}h</div><div style="font-size:10px;color:#64748b;margin-top:3px">Half-Life</div></div>
      </div>
      ${gauge('Selectivity Score',d.selectivity_score)}
      ${gauge('Stability Score',d.stability_score)}
    </div>
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px">
      <div style="background:#f0fdf4;border-radius:10px;padding:14px;border:1px solid #bbf7d0"><div style="font-size:12px;font-weight:700;color:#059669;margin-bottom:8px">‚úÖ Strengths</div>${strengths}</div>
      <div style="background:#fff5f5;border-radius:10px;padding:14px;border:1px solid #fed7d7"><div style="font-size:12px;font-weight:700;color:#dc2626;margin-bottom:8px">‚ö†Ô∏è Weaknesses</div>${weaknesses}</div>
    </div>
    <div style="background:#fffbeb;border-radius:10px;padding:14px;border:1px solid #fde68a">
      <div style="font-size:12px;font-weight:700;color:#d97706;margin-bottom:10px">üí° Optimisation Recommendations</div>${tips}
    </div>
    <div style="background:#eff6ff;border-radius:10px;padding:14px;border:1px solid #bfdbfe">
      <div style="font-size:12px;font-weight:700;color:#1d4ed8;margin-bottom:8px">üè• Clinical Translation Outlook</div>
      <p style="font-size:12px;color:#1e3a5f;line-height:1.65;margin:0">${d.clinical_outlook}</p>
      <div style="margin-top:10px;font-size:12px;color:#1d4ed8;font-weight:600">Closest Analog: ${d.similar_approved}</div>
    </div>
  </div>`;
  show('result');
}
</script>
</body>
</html>
